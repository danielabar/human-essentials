<%= f.fields_for :profile, profile do |pf| %>
  <div class="form-group">
    <% if profile.documents.attached? %>
      <strong>Attached files:</strong>
      <ul>
        <% profile.documents.each do |doc| %>
          <% if doc.persisted? %>
            <li><%= link_to doc.blob['filename'], rails_blob_path(doc), class: "font-weight-bold" %></li>
          <% end %>
        <% end %>
      </ul>
      <%# https://guides.rubyonrails.org/v7.1/active_storage_overview.html#replacing-vs-adding-attachments %>
      <% profile.documents.each do |document| %>
        <% if document.persisted? %>
          <%= pf.hidden_field :documents, multiple: true, value: document.signed_id %>
        <% end %>
      <% end %>
      <%= pf.file_field :documents, multiple: true, class: "form-control-file" %>
    <% else %>
      <%= pf.file_field :documents, multiple: true, class: "form-control-file" %>
    <% end %>
  </div>
<% end %>
